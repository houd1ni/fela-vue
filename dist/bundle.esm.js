import{createRenderer as e,combineRules as t}from"fela";import{renderToMarkup as n,rehydrate as r,render as o}from"fela-dom";import i from"fela-plugin-embedded";import u from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import s from"fela-plugin-unit";import{curry as a,compose as l,replace as f,equals as p,fromPairs as h,map as d,split as y,join as v,filter as g,not as m,type as b,tap as w,bind as O,pickBy as j,unary as x,complement as P,isEmpty as $,isNil as _,toPairs as k,when as S,both as N,length as z,identity as E,always as A,last as C,forEach as R,trim as T}from"ramda";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var F=function(){return(F=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function I(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function U(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],u=0,c=i.length;u<c;u++,o++)r[o]=i[u];return r}var W=function(e,t){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function G(e,t){function n(){this.constructor=e}W(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var H=function(){return(H=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function L(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function Z(e,t){return Object.prototype.hasOwnProperty.call(t,e)}var q,B,D,J,K,M,Q,V,X,Y,ee=function(e){return function t(n){return 0===arguments.length||L(n)?t:e.apply(this,arguments)}}((function(e){var t=[];for(var n in e)Z(n,e)&&(t[t.length]=[n,e[n]]);return t})),te=a((function(e,t){for(var n,r=null,o=null,i=0;i<t.length;i++)n=t[i],e.includes(n)?r&&(o=i):(null==r&&(r=i),o=null);return t.slice(r||0,o||t.length)})),ne=(l(f(/&/g,"\\&"),String),a((function(e,t){var n=t.search(e);return~n?[t.slice(0,n),t.slice(n+1)]:[t]}))),re=(l((function(e){var t=e[0],n=t[0],r=t[1],o=e.slice(1);return{name:n,value:r,attrs:p(o,[null])?{}:h(o)}}),d(l((function(e){var t=e[0],n=e[1];return t?[t,!n||decodeURIComponent(n)]:null}),ne(/=/))),y(/; ?/g)),l(v("; "),g(l(m,p("Null"),b)),d((function(e){var t=e[0],n=e[1];return null===n?null:!0===n?t:t+"="+n})),(function(e){var t=e.name,n=e.value,r=e.attrs;return[[t,n]].concat(ee(r))})),te("/"),a((function(e,t){return H({},t,{headers:H({},t.headers,e)})})),q=function(e,t,n){return function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(u,c)}s((r=r.apply(e,t||[])).next())}))}(null,void 0,void 0,(function(){return function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(r){switch(r.label){case 0:return n<t.length?[4,e(t[n])]:[3,3];case 1:return r.sent(),[4,q(e,t,++n)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},a((function(e,t){return q(e,t,0)})),a((function(e,t){return Promise.all(t.map(e))})),w(O(console.log,console)),l(j,x,P)($)),oe=(a((function(e,t){return l(h,g(P(_)),d((function(t){var n=t[0],r=t[1];return null===e[n]?null:[e[n]||n,r]})),k)(t)})),function(){function e(e){this.pattern=/never/,this.name="Fetch",this.response=e}return Object.defineProperty(e.prototype,"type",{get:function(){return this.name.toLowerCase()},enumerable:!0,configurable:!0}),e.prototype.is=function(e){return this.pattern.test(String(e))},e.prototype.try=function(){var e=this.response;if(this.is(e.status))throw new Error("HTTP "+this.name+" error: status is "+e.status)},e}()),ie=(function(e){function t(t){var n=e.call(this,t)||this;return n.pattern=/4\d[13]/,n.name="Access",n.try(),n}G(t,e)}(oe),function(e){function t(t){var n=e.call(this,t)||this;return n.pattern=/5\d\d/,n.name="Server",n.try(),n}G(t,e)}(oe),Object.freeze({})),ue=Object.freeze({f:"function",o:"object",s:"string"}),ce=function(e){return e.replace(/-(\w)/gu,(function(e,t){return t.toUpperCase()}))},se=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e())}},ae=(B=/url\(.*?\)/g,D=/[,:;]/g,function(e){return e.replace(B,(function(e){return e.replace(D,(function(e){return"\\"+e}))}))}),le=S(P(_),f(/([^\\])\\([^\\])/g,"$1$2")),fe=N(P($),P(_)),pe=function(e,t){return e.reduce((function(e,n,r){return e+n+(t.length>r?t[r]:"")}),"")},he=l(p("Object"),b),de=function(e,t){for(var n in t)he(e[n])&&he(t[n])?de(e[n],t[n]):e[n]=t[n];return e},ye=function(){try{return he(window)}catch(e){return!1}}(),ve=function(e,t){return e[t]||e[ce(t)]},ge=function(e,t,n,r){switch(t||(t=ie),typeof n){case ue.f:return[function(e){return n(e,r)}];case ue.o:return[A(n)];case ue.s:return function(e,t,n){return n.split(/[,\s\t]+/g).map((function(n){return ve(t,n)||ve(e(),n)||ie}))}(e,t,n).reduce((function(n,o){return n.push.apply(n,ge(e,t,o,r)),n}),[]);default:return[E]}},me=function(){function e(e){this.rules={};var t=e.match(/^\.[\w-_]+/);this.s={className:t?t[0].slice(1):null,modifier:t?e.slice(t[0].length)||null:e}}return Object.defineProperty(e.prototype,"complex",{get:function(){return null!==this.s.className&&null!==this.s.modifier},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){var e=this.s,t=e.className;return(t?"."+t:"")+(e.modifier||"")},e}(),be=function(e,t){var n;void 0===t&&(t=0);var r,o,i,u,c,s={};for(c in e.rules)(r=e.rules[c])instanceof me?(o=r.complex?r.s.className:r.serialize(),i=0==t&&"."==o[0]?o.slice(1):"."==o[0]?"& "+o:o,u=r.complex?((n={})[r.s.modifier]=be(r,t+1),n):be(r,t+1),s[i]?de(s[i],u):s[i]=u):s[c]=r;return s},we=function(){function e(){this.path=[],this.path.push([new me("__root")])}return Object.defineProperty(e.prototype,"out",{get:function(){return be(this.path[0][0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var t=C(this.path),n=[],r=0,o=e;r<o.length;r++)for(var i=o[r],u=new me(i),c=0,s=t;c<s.length;c++){var a=s[c],l=u.serialize(),f=a.rules[l];n.push(f||u),f||(a.rules[l]=u)}this.path.push(n)},e.prototype.merge=function(e,t){if(fe(t)&&fe(e))for(var n=0,r=C(this.path);n<r.length;n++){r[n].rules[e]=t}},e.prototype.pop=function(){return this.path.pop()},e}(),Oe=(J=/^([\w-]+)(: *| +)(.*)$/,K=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,M=/\s*,\s*/g,Q=/(.*):$/,function(e,t,n){var r;switch(!0){case"{"==t:e.add(n);break;case"}"==t:e.pop();break;case null!=(r=J.exec(t)):e.merge(le(ce(r[1])),S(isNaN,le,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(r[3])));break;case null!=(r=K.exec(t)):n.splice(0),n.push.apply(n,t.split(M).map((function(e){return e.replace(Q,"$1")})))}}),je={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},xe=(function(){function a(n){var a,l,f,p;void 0===n&&(n={});var h=F(F({},je),n),d=h.method,y=h.ssr,v=h.preset,g=h.plugins,m=h.enhancers,b=I(h,["method","ssr","preset","plugins","enhancers"]),w=F(F({},je.preset),v||{});if(n.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(F(F({},b),{enhancers:m,plugins:U([i(),u(),c(),s.apply(void 0,w.unit)],g)}));var O,j,x=this.renderer,P=n.defStyles;switch(typeof P){case ue.o:O=(a=[P.key,P.value])[0],j=a[1];break;case ue.f:O=(l=["fdef",P])[0],j=l[1]}ye&&(y?r(x):o(x)),this._mixin=re({methods:(f={},f[d]=function(e,n){var r=this;return void 0===n&&(n={}),x.renderRule(t.apply(void 0,ge(se((function(){return j?j(r):ie})),this.style,e,this)),n)||void 0},f),computed:P?(p={},p[O]=function(){return j(this)},p):""})}Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return n(this.renderer)},enumerable:!0,configurable:!0})}(),a((function(e,t){var n,r,o=e[0],i=e[1],u=t.length,c=o.length,s=0,a=[];for(n=0;n<u;n++)switch(t.slice(n,n+c)){case o:n+=c-1,0==s&&(r=n),s++;break;case i:if(n+=c-1,0==--s)a.push([r,n]);else if(s<0)throw new Error("fela-vue literal: unbalanced delimeter in functional expression !")}return a}))),Pe=l(v("\n"),d((function(e){for(var t=[],n=0,r=0,o=xe(["[","]"],e);r<o.length;r++){var i=o[r],u=i[0],c=i[1];t.push(e.slice(n,u),"${"+e.slice(u+1,c).replace(/(\W|^)\$([a-zA-Z_]+)\b/g,"$1$$ps.$2").replace(/(\W|^)@(.+?)\b/g,"$1$t.$2")+"}"),n=c+1}return t.push(e.slice(n)),t.join("")}))),$e=function(e){for(var t,n,r,o=[],i=0,u=[],c=function(){if(i>0)switch(t){case"{":i++,u[u.length-1]+=t;break;case"}":if(1==--i){var e=new Function("$t,css,$ps","return css`\n                "+Pe(u)+"\n              `");o.push([r,function(t,n){return e(n,ke,t)}]),i=0,u.splice(0)}else u[u.length-1]+=t;break;default:u.push(t)}else~(n=t.indexOf("=>"))?(i=1,r=t.slice(0,n).trim().replace(/^\./,"")):o.push(t)},s=0,a=e;s<a.length;s++)t=a[s],c();return o},_e=(V=["\n","\r",";"],X=function(e){return V.includes(e)},Y=/(([\s^]+?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,function(e){var t,n=new we,r=[];return l((function(){return n.out}),R((function(e){if("Array"==b(e))n.merge(e[0],e[1]);else if(e&&Oe(n,e,r),n.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")})),$e,g(P($)),d(T),(t=V,function(e){var n,r,o=d(z,t),i=[],u=0,c=t.length,s=e.length;for(n=0;n<s;n++)for(r=0;r<c;r++)e.slice(n,n+o[r])===t[r]&&"\\"!==e[n-1]&&(i.push(e.slice(u,n)),u=(n+=o[r]-1)+1);return u!==e.length-1&&i.push(e.slice(u)),i}),f(/(\{|\})/g,(function(e,t,n,r){return X(r[n-1])||(t=";"+t),X(r[n+1])||(t+=";"),t})),ae,f(Y,""))(e)}),ke=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return _e(pe(e,t))},Se={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},Ne=function(){function a(n){var a,l,f,p;void 0===n&&(n={});var h=F(F({},Se),n),d=h.method,y=h.ssr,v=h.preset,g=h.plugins,m=h.enhancers,b=I(h,["method","ssr","preset","plugins","enhancers"]),w=F(F({},Se.preset),v||{});if(n.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(F(F({},b),{enhancers:m,plugins:U([i(),u(),c(),s.apply(void 0,w.unit)],g)}));var O,j,x=this.renderer,P=n.defStyles;switch(typeof P){case ue.o:O=(a=[P.key,P.value])[0],j=a[1];break;case ue.f:O=(l=["fdef",P])[0],j=l[1]}ye&&(y?r(x):o(x)),this._mixin=re({methods:(f={},f[d]=function(e,n){var r=this;return void 0===n&&(n={}),x.renderRule(t.apply(void 0,ge(se((function(){return j?j(r):ie})),this.style,e,this)),n)||void 0},f),computed:P?(p={},p[O]=function(){return j(this)},p):""})}return Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return n(this.renderer)},enumerable:!0,configurable:!0}),a}();export{Ne as Renderer,ke as css};
