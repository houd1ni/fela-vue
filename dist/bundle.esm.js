import{createRenderer as e,combineRules as r}from"fela";import{renderToMarkup as t,rehydrate as n,render as i}from"fela-dom";import o from"fela-plugin-embedded";import u from"fela-plugin-prefixer";import s from"fela-plugin-fallback-value";import c from"fela-plugin-unit";import{when as f,complement as a,isNil as l,replace as p,both as h,isEmpty as d,compose as g,equals as m,type as y,map as v,length as b,last as w,identity as O,always as j,curry as x,join as $,forEach as k}from"ramda";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var P=function(){return(P=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)};function z(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]])}return t}function _(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),i=0;for(r=0;r<t;r++)for(var o=arguments[r],u=0,s=o.length;u<s;u++,i++)n[i]=o[u];return n}var N,S,E,A,C,R,F,I,U,Z,q=function(e){return e.replace(/-(\w)/gu,(function(e,r){return r.toUpperCase()}))},B=function(e){var r,t=!1;return function(){return t?r:(t=!0,r=e())}},D=(N=/url\(.*?\)/g,S=/[,:;]/g,function(e){return e.replace(N,(function(e){return e.replace(S,(function(e){return"\\"+e}))}))}),G=f(a(l),p(/([^\\])\\([^\\])/g,"$1$2")),H=h(a(d),a(l)),J=function(e,r){return e.reduce((function(e,t,n){return e+t+(r.length>n?r[n]:"")}),"")},K=g(m("Object"),y),L=function(e,r){for(var t in r)K(e[t])&&K(r[t])?L(e[t],r[t]):e[t]=r[t];return e},M=function(){function e(e){this.rules={};var r=e.match(/^\.[\w-_]+/);this.s={className:r?r[0].slice(1):null,modifier:r?e.slice(r[0].length)||null:e}}return Object.defineProperty(e.prototype,"complex",{get:function(){return null!==this.s.className&&null!==this.s.modifier},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){var e=this.s,r=e.className;return(r?"."+r:"")+(e.modifier||"")},e}(),Q=function(e,r){var t;void 0===r&&(r=0);var n,i,o,u,s,c={};for(s in e.rules)(n=e.rules[s])instanceof M?(i=n.complex?n.s.className:n.serialize(),o=0==r&&"."==i[0]?i.slice(1):"."==i[0]?"& "+i:i,u=n.complex?((t={})[n.s.modifier]=Q(n,r+1),t):Q(n,r+1),c[o]?L(c[o],u):c[o]=u):c[s]=n;return c},T=function(){function e(){this.path=[],this.path.push([new M("__root")])}return Object.defineProperty(e.prototype,"out",{get:function(){return Q(this.path[0][0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var r=w(this.path),t=[],n=0,i=e;n<i.length;n++)for(var o=i[n],u=new M(o),s=0,c=r;s<c.length;s++){var f=c[s],a=u.serialize(),l=f.rules[a];t.push(l||u),l||(f.rules[a]=u)}this.path.push(t)},e.prototype.merge=function(e,r){if(H(r)&&H(e))for(var t=0,n=w(this.path);t<n.length;t++){n[t].rules[e]=r}},e.prototype.pop=function(){return this.path.pop()},e}(),V=(E=/^([\w-]+)(: *| +)(.*)$/,A=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,C=/\s*,\s*/g,R=/(.*):$/,function(e,r,t){var n;switch(!0){case"{"==r:e.add(t);break;case"}"==r:e.pop();break;case null!=(n=E.exec(r)):e.merge(G(q(n[1])),f(isNaN,G,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(n[3])));break;case null!=(n=A.exec(r)):t.splice(0),t.push.apply(t,r.split(C).map((function(e){return e.replace(R,"$1")})))}}),W=Object.freeze({}),X=function(){try{return"object"==typeof window}catch(e){return!1}}(),Y={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},ee=Object.freeze({f:"function",o:"object",s:"string"}),re=(F=function(e,r){return e[r]||e[q(r)]},function(e,r,t){switch(r||(r=W),typeof t){case ee.f:return[t];case ee.o:return[j(t)];case ee.s:return function(e,r,t){return t.split(/[,\s\t]+/g).map((function(t){return F(r,t)||F(e(),t)||W}))}(e,r,t).reduce((function(t,n){return t.push.apply(t,re(e,r,n)),t}),[]);default:return[O]}}),te=(function(){function f(t){var f,a,l,p;void 0===t&&(t={});var h=P(P({},Y),t),d=h.method,g=h.ssr,m=h.preset,y=h.plugins,v=h.enhancers,b=z(h,["method","ssr","preset","plugins","enhancers"]),w=P(P({},Y.preset),m||{});if(t.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(P(P({},b),{enhancers:v,plugins:_([o(),u(),s(),c.apply(void 0,w.unit)],y)}));var O,j,x=this.renderer,$=t.defStyles;switch(typeof $){case ee.o:O=(f=[$.key,$.value])[0],j=f[1];break;case ee.f:O=(a=["fdef",$])[0],j=a[1]}X&&(g?n(x):i(x)),this._mixin={methods:(l={},l[d]=function(e,t){var n=this;return void 0===t&&(t={}),x.renderRule(r.apply(void 0,re(B((function(){return j?j(n):W})),this.style,e)),t)||void 0},l),computed:$?(p={},p[O]=function(){return j(this)},p):{}}}Object.defineProperty(f.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"style",{get:function(){return t(this.renderer)},enumerable:!0,configurable:!0})}(),x((function(e,r){var t,n,i=e[0],o=e[1],u=r.length,s=i.length,c=0,f=[];for(t=0;t<u;t++)switch(r.slice(t,t+s)){case i:t+=s-1,0==c&&(n=t),c++;break;case o:if(t+=s-1,0==--c)f.push([n,t]);else if(c<0)throw new Error("fela-vue literal: unbalanced delimeter in functional expression !")}return f}))),ne=g($("\n"),v((function(e){for(var r=[],t=0,n=0,i=te(["[","]"],e);n<i.length;n++){var o=i[n],u=o[0],s=o[1];r.push(e.slice(t,u),"${"+e.slice(u+1,s).replace(/\$([a-zA-Z_]+)\b/g,"$$.$1")+"}"),t=s+1}return r.push(e.slice(t)),r.join("")}))),ie=function(e){for(var r,t,n,i=[],o=0,u=[],s=function(){if(o>0)switch(r){case"{":o++;break;case"}":if(1==--o){var e=new Function("_css,$","return _css`\n                "+ne(u)+"\n              `");i.push([n,function(r){return e(ue,r)}]),o=0,u.splice(0)}break;default:u.push(r)}else~(t=r.indexOf("=>"))?(o=1,n=r.slice(0,t).trim().replace(/^\./,"")):i.push(r)},c=0,f=e;c<f.length;c++)r=f[c],s();return i},oe=(I=["\n","\r",";"],U=function(e){return I.includes(e)},Z=/(([\s^]+?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,function(e){var r,t=new T,n=[];return g((function(){return t.out}),k((function(e){if("Array"==y(e))t.merge(e[0],e[1]);else if((e=e.trim())&&V(t,e,n),t.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")})),ie,(r=I,function(e){var t,n,i=v(b,r),o=[],u=0,s=r.length,c=e.length;for(t=0;t<c;t++)for(n=0;n<s;n++)e.slice(t,t+i[n])===r[n]&&"\\"!==e[t-1]&&(o.push(e.slice(u,t)),u=(t+=i[n]-1)+1);return u!==e.length-1&&o.push(e.slice(u)),o}),p(/(\{|\})/g,(function(e,r,t,n){return U(n[t-1])||(r=";"+r),U(n[t+1])||(r+=";"),r})),D,p(Z,""))(e)}),ue=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return oe(J(e,r))},se=Object.freeze({}),ce=function(){try{return"object"==typeof window}catch(e){return!1}}(),fe={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},ae=Object.freeze({f:"function",o:"object",s:"string"}),le=function(){var e=function(e,r){return e[r]||e[q(r)]};return function(r,t,n){switch(t||(t=se),typeof n){case ae.f:return[n];case ae.o:return[j(n)];case ae.s:return function(r,t,n){return n.split(/[,\s\t]+/g).map((function(n){return e(t,n)||e(r(),n)||se}))}(r,t,n).reduce((function(e,n){return e.push.apply(e,le(r,t,n)),e}),[]);default:return[O]}}}(),pe=function(){function f(t){var f,a,l,p;void 0===t&&(t={});var h=P(P({},fe),t),d=h.method,g=h.ssr,m=h.preset,y=h.plugins,v=h.enhancers,b=z(h,["method","ssr","preset","plugins","enhancers"]),w=P(P({},fe.preset),m||{});if(t.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(P(P({},b),{enhancers:v,plugins:_([o(),u(),s(),c.apply(void 0,w.unit)],y)}));var O,j,x=this.renderer,$=t.defStyles;switch(typeof $){case ae.o:O=(f=[$.key,$.value])[0],j=f[1];break;case ae.f:O=(a=["fdef",$])[0],j=a[1]}ce&&(g?n(x):i(x)),this._mixin={methods:(l={},l[d]=function(e,t){var n=this;return void 0===t&&(t={}),x.renderRule(r.apply(void 0,le(B((function(){return j?j(n):se})),this.style,e)),t)||void 0},l),computed:$?(p={},p[O]=function(){return j(this)},p):{}}}return Object.defineProperty(f.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"style",{get:function(){return t(this.renderer)},enumerable:!0,configurable:!0}),f}();export{pe as Renderer,ue as css};
