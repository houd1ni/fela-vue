import{createRenderer as e,combineRules as t}from"fela";import{renderToMarkup as n,rehydrate as r,render as o}from"fela-dom";import i from"fela-plugin-embedded";import u from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import s from"fela-plugin-unit";import{curry as a,compose as l,replace as f,equals as p,fromPairs as h,map as d,split as y,join as v,filter as g,not as m,type as b,tap as w,bind as O,pickBy as j,unary as x,complement as P,isEmpty as $,isNil as _,toPairs as k,when as S,both as N,length as z,identity as E,always as A,last as C,forEach as R}from"ramda";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var T=function(){return(T=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function F(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function I(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],u=0,c=i.length;u<c;u++,o++)r[o]=i[u];return r}var U=function(e,t){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function W(e,t){function n(){this.constructor=e}U(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var G=function(){return(G=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function H(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function L(e,t){return Object.prototype.hasOwnProperty.call(t,e)}var Z,q,B,D,J,K,M,Q,V,X,Y=function(e){return function t(n){return 0===arguments.length||H(n)?t:e.apply(this,arguments)}}((function(e){var t=[];for(var n in e)L(n,e)&&(t[t.length]=[n,e[n]]);return t})),ee=a((function(e,t){for(var n,r=null,o=null,i=0;i<t.length;i++)n=t[i],e.includes(n)?r&&(o=i):(null==r&&(r=i),o=null);return t.slice(r||0,o||t.length)})),te=(l(f(/&/g,"\\&"),String),a((function(e,t){var n=t.search(e);return~n?[t.slice(0,n),t.slice(n+1)]:[t]}))),ne=(l((function(e){var t=e[0],n=t[0],r=t[1],o=e.slice(1);return{name:n,value:r,attrs:p(o,[null])?{}:h(o)}}),d(l((function(e){var t=e[0],n=e[1];return t?[t,!n||decodeURIComponent(n)]:null}),te(/=/))),y(/; ?/g)),l(v("; "),g(l(m,p("Null"),b)),d((function(e){var t=e[0],n=e[1];return null===n?null:!0===n?t:t+"="+n})),(function(e){var t=e.name,n=e.value,r=e.attrs;return[[t,n]].concat(Y(r))})),ee("/"),a((function(e,t){return G({},t,{headers:G({},t.headers,e)})})),Z=function(e,t,n){return function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(u,c)}s((r=r.apply(e,t||[])).next())}))}(null,void 0,void 0,(function(){return function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(r){switch(r.label){case 0:return n<t.length?[4,e(t[n])]:[3,3];case 1:return r.sent(),[4,Z(e,t,++n)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},a((function(e,t){return Z(e,t,0)})),a((function(e,t){return Promise.all(t.map(e))})),w(O(console.log,console)),l(j,x,P)($)),re=(a((function(e,t){return l(h,g(P(_)),d((function(t){var n=t[0],r=t[1];return null===e[n]?null:[e[n]||n,r]})),k)(t)})),function(){function e(e){this.pattern=/never/,this.name="Fetch",this.response=e}return Object.defineProperty(e.prototype,"type",{get:function(){return this.name.toLowerCase()},enumerable:!0,configurable:!0}),e.prototype.is=function(e){return this.pattern.test(String(e))},e.prototype.try=function(){var e=this.response;if(this.is(e.status))throw new Error("HTTP "+this.name+" error: status is "+e.status)},e}()),oe=(function(e){function t(t){var n=e.call(this,t)||this;return n.pattern=/4\d[13]/,n.name="Access",n.try(),n}W(t,e)}(re),function(e){function t(t){var n=e.call(this,t)||this;return n.pattern=/5\d\d/,n.name="Server",n.try(),n}W(t,e)}(re),Object.freeze({})),ie=Object.freeze({f:"function",o:"object",s:"string"}),ue=function(e){return e.replace(/-(\w)/gu,(function(e,t){return t.toUpperCase()}))},ce=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e())}},se=(q=/url\(.*?\)/g,B=/[,:;]/g,function(e){return e.replace(q,(function(e){return e.replace(B,(function(e){return"\\"+e}))}))}),ae=S(P(_),f(/([^\\])\\([^\\])/g,"$1$2")),le=N(P($),P(_)),fe=function(e,t){return e.reduce((function(e,n,r){return e+n+(t.length>r?t[r]:"")}),"")},pe=l(p("Object"),b),he=function(e,t){for(var n in t)pe(e[n])&&pe(t[n])?he(e[n],t[n]):e[n]=t[n];return e},de=function(){try{return pe(window)}catch(e){return!1}}(),ye=function(e,t){return e[t]||e[ue(t)]},ve=function(e,t,n,r){switch(t||(t=oe),typeof n){case ie.f:return[function(e){return n(e,r)}];case ie.o:return[A(n)];case ie.s:return function(e,t,n){return n.split(/[,\s\t]+/g).map((function(n){return ye(t,n)||ye(e(),n)||oe}))}(e,t,n).reduce((function(n,o){return n.push.apply(n,ve(e,t,o,r)),n}),[]);default:return[E]}},ge=function(){function e(e){this.rules={};var t=e.match(/^\.[\w-_]+/);this.s={className:t?t[0].slice(1):null,modifier:t?e.slice(t[0].length)||null:e}}return Object.defineProperty(e.prototype,"complex",{get:function(){return null!==this.s.className&&null!==this.s.modifier},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){var e=this.s,t=e.className;return(t?"."+t:"")+(e.modifier||"")},e}(),me=function(e,t){var n;void 0===t&&(t=0);var r,o,i,u,c,s={};for(c in e.rules)(r=e.rules[c])instanceof ge?(o=r.complex?r.s.className:r.serialize(),i=0==t&&"."==o[0]?o.slice(1):"."==o[0]?"& "+o:o,u=r.complex?((n={})[r.s.modifier]=me(r,t+1),n):me(r,t+1),s[i]?he(s[i],u):s[i]=u):s[c]=r;return s},be=function(){function e(){this.path=[],this.path.push([new ge("__root")])}return Object.defineProperty(e.prototype,"out",{get:function(){return me(this.path[0][0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var t=C(this.path),n=[],r=0,o=e;r<o.length;r++)for(var i=o[r],u=new ge(i),c=0,s=t;c<s.length;c++){var a=s[c],l=u.serialize(),f=a.rules[l];n.push(f||u),f||(a.rules[l]=u)}this.path.push(n)},e.prototype.merge=function(e,t){if(le(t)&&le(e))for(var n=0,r=C(this.path);n<r.length;n++){r[n].rules[e]=t}},e.prototype.pop=function(){return this.path.pop()},e}(),we=(D=/^([\w-]+)(: *| +)(.*)$/,J=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,K=/\s*,\s*/g,M=/(.*):$/,function(e,t,n){var r;switch(!0){case"{"==t:e.add(n);break;case"}"==t:e.pop();break;case null!=(r=D.exec(t)):e.merge(ae(ue(r[1])),S(isNaN,ae,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(r[3])));break;case null!=(r=J.exec(t)):n.splice(0),n.push.apply(n,t.split(K).map((function(e){return e.replace(M,"$1")})))}}),Oe={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},je=(function(){function a(n){var a,l,f,p;void 0===n&&(n={});var h=T(T({},Oe),n),d=h.method,y=h.ssr,v=h.preset,g=h.plugins,m=h.enhancers,b=F(h,["method","ssr","preset","plugins","enhancers"]),w=T(T({},Oe.preset),v||{});if(n.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(T(T({},b),{enhancers:m,plugins:I([i(),u(),c(),s.apply(void 0,w.unit)],g)}));var O,j,x=this.renderer,P=n.defStyles;switch(typeof P){case ie.o:O=(a=[P.key,P.value])[0],j=a[1];break;case ie.f:O=(l=["fdef",P])[0],j=l[1]}de&&(y?r(x):o(x)),this._mixin=ne({methods:(f={},f[d]=function(e,n){var r=this;return void 0===n&&(n={}),x.renderRule(t.apply(void 0,ve(ce((function(){return j?j(r):oe})),this.style,e,this)),n)||void 0},f),computed:P?(p={},p[O]=function(){return j(this)},p):""})}Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return n(this.renderer)},enumerable:!0,configurable:!0})}(),a((function(e,t){var n,r,o=e[0],i=e[1],u=t.length,c=o.length,s=0,a=[];for(n=0;n<u;n++)switch(t.slice(n,n+c)){case o:n+=c-1,0==s&&(r=n),s++;break;case i:if(n+=c-1,0==--s)a.push([r,n]);else if(s<0)throw new Error("fela-vue literal: unbalanced delimeter in functional expression !")}return a}))),xe=l(v("\n"),d((function(e){for(var t=[],n=0,r=0,o=je(["[","]"],e);r<o.length;r++){var i=o[r],u=i[0],c=i[1];t.push(e.slice(n,u),"${"+e.slice(u+1,c).replace(/(\W|^)\$([a-zA-Z_]+)\b/g,"$1$$ps.$2").replace(/(\W|^)@(.+?)\b/g,"$1$t.$2")+"}"),n=c+1}return t.push(e.slice(n)),t.join("")}))),Pe=function(e){for(var t,n,r,o=[],i=0,u=[],c=function(){if(i>0)switch(t){case"{":i++,u[u.length-1]+=t;break;case"}":if(1==--i){var e=new Function("$t,css,$ps","return css`\n                "+xe(u)+"\n              `");o.push([r,function(t,n){return e(n,_e,t)}]),i=0,u.splice(0)}else u[u.length-1]+=t;break;default:u.push(t)}else~(n=t.indexOf("=>"))?(i=1,r=t.slice(0,n).trim().replace(/^\./,"")):o.push(t)},s=0,a=e;s<a.length;s++)t=a[s],c();return o},$e=(Q=["\n","\r",";"],V=function(e){return Q.includes(e)},X=/(([\s^]+?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,function(e){var t,n=new be,r=[];return l((function(){return n.out}),R((function(e){if("Array"==b(e))n.merge(e[0],e[1]);else if((e=e.trim())&&we(n,e,r),n.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")})),Pe,(t=Q,function(e){var n,r,o=d(z,t),i=[],u=0,c=t.length,s=e.length;for(n=0;n<s;n++)for(r=0;r<c;r++)e.slice(n,n+o[r])===t[r]&&"\\"!==e[n-1]&&(i.push(e.slice(u,n)),u=(n+=o[r]-1)+1);return u!==e.length-1&&i.push(e.slice(u)),i}),f(/(\{|\})/g,(function(e,t,n,r){return V(r[n-1])||(t=";"+t),V(r[n+1])||(t+=";"),t})),se,f(X,""))(e)}),_e=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return $e(fe(e,t))},ke={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},Se=function(){function a(n){var a,l,f,p;void 0===n&&(n={});var h=T(T({},ke),n),d=h.method,y=h.ssr,v=h.preset,g=h.plugins,m=h.enhancers,b=F(h,["method","ssr","preset","plugins","enhancers"]),w=T(T({},ke.preset),v||{});if(n.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(T(T({},b),{enhancers:m,plugins:I([i(),u(),c(),s.apply(void 0,w.unit)],g)}));var O,j,x=this.renderer,P=n.defStyles;switch(typeof P){case ie.o:O=(a=[P.key,P.value])[0],j=a[1];break;case ie.f:O=(l=["fdef",P])[0],j=l[1]}de&&(y?r(x):o(x)),this._mixin=ne({methods:(f={},f[d]=function(e,n){var r=this;return void 0===n&&(n={}),x.renderRule(t.apply(void 0,ve(ce((function(){return j?j(r):oe})),this.style,e,this)),n)||void 0},f),computed:P?(p={},p[O]=function(){return j(this)},p):""})}return Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return n(this.renderer)},enumerable:!0,configurable:!0}),a}();export{Se as Renderer,_e as css};
