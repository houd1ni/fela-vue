import{createRenderer as e,combineRules as r}from"fela";import{renderToMarkup as t,rehydrate as n,render as i}from"fela-dom";import o from"fela-plugin-embedded";import u from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import a from"fela-plugin-unit";import{when as s,complement as f,isNil as l,replace as p,both as h,isEmpty as d,compose as m,equals as g,type as b,map as y,length as v,last as w,forEach as O,identity as j,always as x}from"ramda";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var $=function(){return($=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)};function P(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),i=0;for(r=0;r<t;r++)for(var o=arguments[r],u=0,c=o.length;u<c;u++,i++)n[i]=o[u];return n}var k,N,z,S,_,A,E,C,F,I,R=function(e){return e.replace(/-(\w)/gu,(function(e,r){return r.toUpperCase()}))},U=function(e){var r,t=!1;return function(){return t?r:(t=!0,r=e())}},Z=(k=/url\(.*?\)/g,N=/[,:;]/g,function(e){return e.replace(k,(function(e){return e.replace(N,(function(e){return"\\"+e}))}))}),q=s(f(l),p(/([^\\])\\([^\\])/g,"$1$2")),B=h(f(d),f(l)),D=function(e,r){return e.reduce((function(e,t,n){return e+t+r[n]}),"")},G=m(g("Object"),b),H=function(e,r){for(var t in r)G(e[t])&&G(r[t])?H(e[t],r[t]):e[t]=r[t];return e},J=function(e){for(var r,t,n,i=[],o=0,u=[],c=0,a=e;c<a.length;c++)if(r=a[c],o>0)switch(r){case"{":o++;break;case"}":1==--o&&(i.push([n,new Function("$","return css`\n                  "+u.join("\n").replace(/\[(.*?)\]/g,(function(e,r){return"${"+r.replace(/\b([a-zA-Z]+)\b/g,"$$.$1")+"}"}))+"\n                `")]),o=0,u.splice(0));break;default:u.push(r)}else~(t=r.indexOf("=>"))?(o=1,n=r.slice(0,t).trim().replace(/^\./,"")):i.push(r);return i},K=(z=/^([\w-]+)(: *| +)(.*)$/,S=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,_=/\s*,\s*/g,A=/(.*):$/,function(e,r,t){var n;switch(!0){case"{"==r:e.add(t);break;case"}"==r:e.pop();break;case null!=(n=z.exec(r)):e.merge(q(R(n[1])),s(isNaN,q,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(n[3])));break;case null!=(n=S.exec(r)):t.splice(0),t.push.apply(t,r.split(_).map((function(e){return e.replace(A,"$1")})))}}),L=function(){function e(e){this.rules={};var r=e.match(/\.[\w-_]+/);this.s={className:r?r[0].slice(1):null,modifier:r?e.slice(r[0].length)||null:e}}return Object.defineProperty(e.prototype,"complex",{get:function(){return null!==this.s.className&&null!==this.s.modifier},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){var e=this.s,r=e.className;return(r?"."+r:"")+(e.modifier||"")},e}(),M=function(e,r){var t;void 0===r&&(r=0);var n,i,o,u,c,a={};for(c in e.rules)(n=e.rules[c])instanceof L?(i=n.complex?n.s.className:n.serialize(),o=0==r&&"."==i[0]?i.slice(1):"."==i[0]?"& "+i:i,u=n.complex?((t={})[n.s.modifier]=M(n,r+1),t):M(n,r+1),a[o]?H(a[o],u):a[o]=u):a[c]=n;return a},Q=function(){function e(){this.path=[],this.path.push([new L("__root")])}return Object.defineProperty(e.prototype,"out",{get:function(){return M(this.path[0][0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var r=w(this.path),t=[],n=0,i=e;n<i.length;n++)for(var o=i[n],u=new L(o),c=0,a=r;c<a.length;c++){var s=a[c],f=u.serialize(),l=s.rules[f];t.push(l||u),l||(s.rules[f]=u)}this.path.push(t)},e.prototype.merge=function(e,r){if(B(r)&&B(e))for(var t=0,n=w(this.path);t<n.length;t++){n[t].rules[e]=r}},e.prototype.pop=function(){return this.path.pop()},e}(),T=(E=["\n","\r",";"],C=function(e){return E.includes(e)},F=/(([\s^]+?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,function(e){var r,t=new Q,n=[];return m((function(){return t.out}),O((function(e){if("Array"==b(e))t.merge(e[0],e[1]);else if((e=e.trim())&&K(t,e,n),t.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")})),J,(r=E,function(e){var t,n,i=y(v,r),o=[],u=0,c=r.length,a=e.length;for(t=0;t<a;t++)for(n=0;n<c;n++)e.slice(t,t+i[n])===r[n]&&"\\"!==e[t-1]&&(o.push(e.slice(u,t)),u=(t+=i[n]-1)+1);return u!==e.length-1&&o.push(e.slice(u)),o}),p(/(\{|\})/g,(function(e,r,t,n){return C(n[t-1])||(r=";"+r),C(n[t+1])||(r+=";"),r})),Z,p(F,""))(e)}),V=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return T(D(e,r))},W=Object.freeze({}),X=function(){try{return"object"==typeof window}catch(e){return!1}}(),Y={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},ee=Object.freeze({f:"function",o:"object",s:"string"}),re=(I=function(e,r){return e[r]||e[R(r)]},function(e,r,t){switch(r||(r=W),typeof t){case ee.f:return[t];case ee.o:return[x(t)];case ee.s:return function(e,r,t){return t.split(/[,\s\t]+/g).map((function(t){return I(r,t)||I(e(),t)||W}))}(e,r,t).reduce((function(t,n){return t.push.apply(t,re(e,r,n)),t}),[]);default:return[j]}}),te=function(){function s(t){var s,f,l,p;void 0===t&&(t={});var h=$($({},Y),t),d=h.method,m=h.ssr,g=h.preset,b=h.plugins,y=h.enhancers,v=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]])}return t}(h,["method","ssr","preset","plugins","enhancers"]),w=$($({},Y.preset),g||{});if(t.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e($($({},v),{enhancers:y,plugins:P([o(),u(),c(),a.apply(void 0,w.unit)],b)}));var O,j,x=this.renderer,k=t.defStyles;switch(typeof k){case ee.o:O=(s=[k.key,k.value])[0],j=s[1];break;case ee.f:O=(f=["fdef",k])[0],j=f[1]}X&&(m?n(x):i(x)),this._mixin={methods:(l={},l[d]=function(e,t){var n=this;return void 0===t&&(t={}),x.renderRule(r.apply(void 0,re(U((function(){return j?j(n):W})),this.style,e)),t)||void 0},l),computed:k?(p={},p[O]=function(){return j(this)},p):{}}}return Object.defineProperty(s.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"style",{get:function(){return t(this.renderer)},enumerable:!0,configurable:!0}),s}();export{te as Renderer,V as css};
