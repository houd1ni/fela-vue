import{createRenderer as e,combineRules as r}from"fela";import{renderToMarkup as t,rehydrate as n,render as i}from"fela-dom";import o from"fela-plugin-embedded";import u from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import s from"fela-plugin-unit";import{when as f,complement as a,isNil as l,replace as p,both as h,isEmpty as d,compose as m,equals as g,type as y,map as b,length as v,last as w,identity as O,always as j,forEach as x}from"ramda";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var $=function(){return($=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)};function P(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]])}return t}function k(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),i=0;for(r=0;r<t;r++)for(var o=arguments[r],u=0,c=o.length;u<c;u++,i++)n[i]=o[u];return n}var z,_,N,S,E,A,C,R,F,I,U=function(e){return e.replace(/-(\w)/gu,(function(e,r){return r.toUpperCase()}))},Z=function(e){var r,t=!1;return function(){return t?r:(t=!0,r=e())}},q=(z=/url\(.*?\)/g,_=/[,:;]/g,function(e){return e.replace(z,(function(e){return e.replace(_,(function(e){return"\\"+e}))}))}),B=f(a(l),p(/([^\\])\\([^\\])/g,"$1$2")),D=h(a(d),a(l)),G=function(e,r){return e.reduce((function(e,t,n){return e+t+(r.length<n?r[n]:"")}),"")},H=m(g("Object"),y),J=function(e,r){for(var t in r)H(e[t])&&H(r[t])?J(e[t],r[t]):e[t]=r[t];return e},K=function(){function e(e){this.rules={};var r=e.match(/^\.[\w-_]+$/);this.s={className:r?r[0].slice(1):null,modifier:r?e.slice(r[0].length)||null:e}}return Object.defineProperty(e.prototype,"complex",{get:function(){return null!==this.s.className&&null!==this.s.modifier},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){var e=this.s,r=e.className;return(r?"."+r:"")+(e.modifier||"")},e}(),L=function(e,r){var t;void 0===r&&(r=0);var n,i,o,u,c,s={};for(c in e.rules)(n=e.rules[c])instanceof K?(i=n.complex?n.s.className:n.serialize(),o=0==r&&"."==i[0]?i.slice(1):"."==i[0]?"& "+i:i,u=n.complex?((t={})[n.s.modifier]=L(n,r+1),t):L(n,r+1),s[o]?J(s[o],u):s[o]=u):s[c]=n;return s},M=function(){function e(){this.path=[],this.path.push([new K("__root")])}return Object.defineProperty(e.prototype,"out",{get:function(){return L(this.path[0][0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var r=w(this.path),t=[],n=0,i=e;n<i.length;n++)for(var o=i[n],u=new K(o),c=0,s=r;c<s.length;c++){var f=s[c],a=u.serialize(),l=f.rules[a];t.push(l||u),l||(f.rules[a]=u)}this.path.push(t)},e.prototype.merge=function(e,r){if(D(r)&&D(e))for(var t=0,n=w(this.path);t<n.length;t++){n[t].rules[e]=r}},e.prototype.pop=function(){return this.path.pop()},e}(),Q=(N=/^([\w-]+)(: *| +)(.*)$/,S=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,E=/\s*,\s*/g,A=/(.*):$/,function(e,r,t){var n;switch(!0){case"{"==r:e.add(t);break;case"}"==r:e.pop();break;case null!=(n=N.exec(r)):e.merge(B(U(n[1])),f(isNaN,B,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(n[3])));break;case null!=(n=S.exec(r)):t.splice(0),t.push.apply(t,r.split(E).map((function(e){return e.replace(A,"$1")})))}}),T=Object.freeze({}),V=function(){try{return"object"==typeof window}catch(e){return!1}}(),W={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},X=Object.freeze({f:"function",o:"object",s:"string"}),Y=(C=function(e,r){return e[r]||e[U(r)]},function(e,r,t){switch(r||(r=T),typeof t){case X.f:return[t];case X.o:return[j(t)];case X.s:return function(e,r,t){return t.split(/[,\s\t]+/g).map((function(t){return C(r,t)||C(e(),t)||T}))}(e,r,t).reduce((function(t,n){return t.push.apply(t,Y(e,r,n)),t}),[]);default:return[O]}}),ee=(function(){function f(t){var f,a,l,p;void 0===t&&(t={});var h=$($({},W),t),d=h.method,m=h.ssr,g=h.preset,y=h.plugins,b=h.enhancers,v=P(h,["method","ssr","preset","plugins","enhancers"]),w=$($({},W.preset),g||{});if(t.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e($($({},v),{enhancers:b,plugins:k([o(),u(),c(),s.apply(void 0,w.unit)],y)}));var O,j,x=this.renderer,z=t.defStyles;switch(typeof z){case X.o:O=(f=[z.key,z.value])[0],j=f[1];break;case X.f:O=(a=["fdef",z])[0],j=a[1]}V&&(m?n(x):i(x)),this._mixin={methods:(l={},l[d]=function(e,t){var n=this;return void 0===t&&(t={}),x.renderRule(r.apply(void 0,Y(Z((function(){return j?j(n):T})),this.style,e)),t)||void 0},l),computed:z?(p={},p[O]=function(){return j(this)},p):{}}}Object.defineProperty(f.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"style",{get:function(){return t(this.renderer)},enumerable:!0,configurable:!0})}(),function(e){for(var r,t,n,i=[],o=0,u=[],c=function(){if(o>0)switch(r){case"{":o++;break;case"}":if(1==--o){var e=new Function("_css,$","return _css`\n                "+u.join("\n").replace(/\[(.*?)\]/g,(function(e,r){return"${"+r.replace(/\b([a-zA-Z]+)\b/g,"$$.$1")+"}"}))+"\n              `");i.push([n,function(r){return e(te,r)}]),o=0,u.splice(0)}break;default:u.push(r)}else~(t=r.indexOf("=>"))?(o=1,n=r.slice(0,t).trim().replace(/^\./,"")):i.push(r)},s=0,f=e;s<f.length;s++)r=f[s],c();return i}),re=(R=["\n","\r",";"],F=function(e){return R.includes(e)},I=/(([\s^]+?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,function(e){var r,t=new M,n=[];return m((function(){return t.out}),x((function(e){if("Array"==y(e))t.merge(e[0],e[1]);else if((e=e.trim())&&Q(t,e,n),t.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")})),ee,(r=R,function(e){var t,n,i=b(v,r),o=[],u=0,c=r.length,s=e.length;for(t=0;t<s;t++)for(n=0;n<c;n++)e.slice(t,t+i[n])===r[n]&&"\\"!==e[t-1]&&(o.push(e.slice(u,t)),u=(t+=i[n]-1)+1);return u!==e.length-1&&o.push(e.slice(u)),o}),p(/(\{|\})/g,(function(e,r,t,n){return F(n[t-1])||(r=";"+r),F(n[t+1])||(r+=";"),r})),q,p(I,""))(e)}),te=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return re(G(e,r))},ne=Object.freeze({}),ie=function(){try{return"object"==typeof window}catch(e){return!1}}(),oe={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},ue=Object.freeze({f:"function",o:"object",s:"string"}),ce=function(){var e=function(e,r){return e[r]||e[U(r)]};return function(r,t,n){switch(t||(t=ne),typeof n){case ue.f:return[n];case ue.o:return[j(n)];case ue.s:return function(r,t,n){return n.split(/[,\s\t]+/g).map((function(n){return e(t,n)||e(r(),n)||ne}))}(r,t,n).reduce((function(e,n){return e.push.apply(e,ce(r,t,n)),e}),[]);default:return[O]}}}(),se=function(){function f(t){var f,a,l,p;void 0===t&&(t={});var h=$($({},oe),t),d=h.method,m=h.ssr,g=h.preset,y=h.plugins,b=h.enhancers,v=P(h,["method","ssr","preset","plugins","enhancers"]),w=$($({},oe.preset),g||{});if(t.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e($($({},v),{enhancers:b,plugins:k([o(),u(),c(),s.apply(void 0,w.unit)],y)}));var O,j,x=this.renderer,z=t.defStyles;switch(typeof z){case ue.o:O=(f=[z.key,z.value])[0],j=f[1];break;case ue.f:O=(a=["fdef",z])[0],j=a[1]}ie&&(m?n(x):i(x)),this._mixin={methods:(l={},l[d]=function(e,t){var n=this;return void 0===t&&(t={}),x.renderRule(r.apply(void 0,ce(Z((function(){return j?j(n):ne})),this.style,e)),t)||void 0},l),computed:z?(p={},p[O]=function(){return j(this)},p):{}}}return Object.defineProperty(f.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"style",{get:function(){return t(this.renderer)},enumerable:!0,configurable:!0}),f}();export{se as Renderer,te as css};
