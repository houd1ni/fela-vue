"use strict";var e=require("pepka"),t=require("fela"),r=require("fela-dom"),s=require("fela-plugin-embedded"),n=require("fela-plugin-prefixer"),o=require("fela-plugin-fallback-value"),i=require("fela-plugin-unit");const l=Object.freeze({}),c=Object.freeze({f:"function",o:"object",s:"string"}),a=e=>e.replace(/-(\w)/gu,((e,t)=>t.toUpperCase())),u=(()=>{const e=/url\(.*?\)/g,t=/[,:;]/g;return r=>r.replace(e,(e=>e.replace(t,(e=>`\\${e}`))))})(),f=e.when(e.complement(e.isNil),e.replace(/([^\\])\\([^\\])/g,"$1$2")),p=e.both(e.complement(e.isEmpty),e.complement(e.isNil));e.compose(e.equals("Object"),e.type);const d=e.compose(e.equals("Window"),e.type),h=(()=>{try{return d(window)}catch{return!1}})(),m=e.map(e.ifElse(e.compose(e.equals("Function"),e.type),e.identity,e.prop("default"))),g=(t,r)=>e.compose(e.map((([e,t])=>((e,t,r)=>r(...e[t]||[]))(r,e,t))),e.toPairs,m)(t),b=/((\s+?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,y=/(^|\r|\n)+[\t ]+/g,w=/([;\n\r]){2,}/g,$=/(?:(}|{|]|)^[;\n\r ]+)|(?:[;\n\r ]+($|}|{|]))/g,x=/^([\w-]+)(: *| +)(.*)$/,S=/[^\$](^|\r|\n|;|{)\s*([a-z-]+)[ :][\t ]*?:?[\t ]*?([^;\r\n]+)/g,C=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,v=/^\.\.\.(\S*)$/,N=/^@media /,k=/\s*,\s*/g,q=/(.*):$/,_=/[.&]/,j=/[\n\r]/g,E=/css\`((.|\s)*?)\`/g,z=/\${(?:[^{}]|{(?:[^{}]|{[^{}]*})*})*}/g;class O{s;rules={};__selector__=!0;get complex(){return null!==this.s.className&&null!==this.s.modifier}static isSelector(e){return Boolean(e&&e.__selector__)}serialize(){const{className:e,modifier:t}=this.s;return(e?`.${e}`:"")+(t||"")}findClass(e,t=this){if(t.s.className===e)return t;for(const r in t.rules){const s=t.rules[r];if(O.isSelector(s)){const t=s.findClass(e);if(t)return t}}return null}constructor(e){const t=e.match(/^\.[\w-_]+/);this.s={className:t?t[0].slice(1):null,modifier:t?e.slice(t[0].length)||null:e}}}const P=(t,r=0)=>{const s={};let n,o,i,l,c;for(c in t.rules)n=t.rules[c],O.isSelector(n)?(o=n.complex?n.s.className:n.serialize(),i=0==r&&"."==o[0]?o.slice(1):"."==o[0]?`& ${o}`:o,l=n.complex?{[n.s.modifier]:P(n,r+1)}:P(n,r+1),s[i]?e.qmergeDeep(s[i],l):s[i]=l):s[c]=n;return s};class A{path=[];get out(){return P(this.path[0][0])}get depth(){return this.path.length}add(t){const r=e.last(this.path),s=[];for(const e of t){const t=new O(e);for(const e of r){const r=t.serialize(),n=e.rules[r];s.push(n||t),n||(e.rules[r]=t)}}this.path.push(s)}merge(t,r){if(p(r)&&p(t))for(const s of e.last(this.path))s.rules[t]=r}findClass(e){for(const t of this.path)for(const r of t){const t=r.findClass(e);if(t)return t}return null}pop(){return this.path.pop()}constructor(){this.path.push([new O("__root")])}}const R=Symbol("Placeholder"),B=e=>{let t=0;for(const r of e)r!==R&&t++;return t},M=(e,t)=>{const r=e.length,s=e.slice(),n=t.length;let o=n,i=0;for(;o&&i<r;i++)s[i]===R&&(s[i]=t[n-o],o--);for(i=r;o;i++,o--)s[i]=t[n-o];return s},F=(e,t,r)=>{const s=e.length-t.length-B(r);if(s<1)return e(...M(t,r));{const n=(...s)=>F(e,M(t,r),s);return n.$args_left=s,n}},W=e=>(...t)=>e.length>B(t)?F(e,[],t):e(...t);function L(e){return function(t,r){const s=t===R;if(1===arguments.length&&s)throw new Error("Senseless placeholder usage.");return arguments.length>1?s?(e=>function(t){return t===R?e:e(t)})((t=>e(t,r))):e(t,r):r=>e(t,r)}}function U(e){return W(e)}const D=void 0,T=1/0,Z=e=>typeof e,G=e=>null===e,H={u:"U",b:"B",n:"N",s:"S",f:"F"},I=e=>{const t=Z(e);return"object"===t?G(e)?"Null":e.constructor.name:H[t[0]]+t.slice(1)},J=L(((e,t)=>(t.push(e),t))),K=U(((e,t,r)=>r.reduce(e,t))),Q=U(((e,t,r)=>{for(let s in r)switch(I(r[s])){case"Array":if(e>1&&"Array"===I(t[s]))switch(e){case 2:const n=t[s],o=r[s];for(const t in o)n[t]?Q(e,n[t],o[t]):n[t]=o[t];break;case 3:t[s].push(...r[s])}else t[s]=r[s];break;case"Object":if("Object"===I(t[s])){Q(e,t[s],r[s]);break}default:t[s]=r[s]}return t}));Q(1),Q(2),Q(3);const V=L(((e,t)=>{const r=I(e);if(r===I(t)&&("Object"===r||"Array"==r)){if(G(e)||G(t))return e===t;if(e===t)return!0;for(const r of[e,t])for(const s in r)if(!(r===t&&s in e||r===e&&s in t&&V(e[s],t[s])))return!1;return!0}return e===t})),X=W(((e,t,r,s)=>e(s)?t(s):r(s))),Y=(...e)=>(...t)=>{let r,s=!0;for(let n=oe(e)-1;n>-1;n--)s?(s=!1,r=e[n](...t)):r=r===R?e[n]():e[n](r);return r},ee=L(((e,t)=>t[e])),te=L(((e,t)=>{if((e=>"string"===Z(e))(t))return t.includes(e);for(const r of t)if(V(r,e))return!0;return!1})),re=U(((e,t,r)=>r.slice(e,(e=>"number"==Z(e))(t)?t:T))),se=ee(0);re(1,T);const ne=e=>G(e)||(e=>e===D)(e),oe=e=>e.length,ie=e=>()=>e,le=L(((e,t)=>t.split(e))),ce=e=>K(((e,t)=>te(t,e)?e:J(t,e)),[],e),ae=U(((e,t,r)=>({...r,[e]:t}))),ue=L(((e,t)=>t[e])),fe=U(((e,t,r)=>X(oe,(()=>ne(r)?e:Y(X(ne,ie(e),(r=>fe(e,re(1,T,t),r))),(e=>L(((t,r)=>e(r,t))))(ue)(r),se)(t)),ie(r),t)));fe(D);const pe=/^(.*?)(8|16|32|64)(Clamped)?Array$/,de=(e,t=!1)=>{const r=I(e);switch(r){case"Null":case"String":case"Number":case"Boolean":case"Symbol":return e;case"Array":return t?[...e]:me(Y(de,((...e)=>e[0])),e);case"Object":if(t)return{...e};const s={};for(let t in e)s[t]=de(e[t]);return s;default:return pe.test(r)?e.constructor.from(e):e}},he=U(((e,t,r)=>K(e,de(t),r))),me=L(((e,t)=>t.map(e))),{floor:ge}=Math;let be,ye;const we=Y((e=>he(((e,t)=>ae(...t,e)),{},e)),me(((e,t)=>[e,t])),le(""));(e=>{if(!(e=>Y(V(oe(e)),oe,ce,le(""))(e))(e))throw new Error("Not all chars are unique!");be=e,ye=be.length,we(be)})("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");const $e="\ntop flex grid overflow transform transition-duration max-height 100%\nmargin margin-top margin-left margin-bottom margin-right justify-content\nborder width height left border-radius background bottom position align-items\ncenter bottom absolute relative float right opacity z-index min-width\nmin-height border-top border-bottom border-left border-right filter\nfont-family font-size font-weight none hidden auto display block inline inline-block\npadding padding-top padding-bottom padding-left padding-right text-align\nflex-direction column box-shadow rotate content text-decoration max-width\nfixed color space-between overflow-x overflow-y background-size\n".replace(/\s+/g,",").split(/[, ]/g).filter(Boolean),xe=()=>{let e=0;return()=>`a${(e=>{let t="";for(;e>0;)t=be[e%ye]+t,e=ge(e/ye);return t||"0"})(e++)}`},Se=e=>{const t=xe(),{compose:r,fromPairs:s,map:n,qreverse:o,toPairs:i}=e,l=r(s,n((e=>[e,t()])))($e);return{dic:l,dicRev:r(s,o,i)(l)}};let Ce=!1;const ve=Se({compose:e.compose,fromPairs:e.fromPairs,map:e.map,reverse:e.reverse,toPairs:e.toPairs}),Ne=(()=>{const t=x,r=C,s=v,n=k,o=N,i=q,l=e.when((()=>Ce),(e=>ve.dicRev[e]||e));return(c,u,p)=>{let d;switch(!0){case"{"==u:c.add(p);break;case"}"==u:c.pop();break;case null!==(d=s.exec(u)):const h=c.findClass(d[1]);if(h)for(const e in h.rules)c.merge(e,h.rules[e]);break;case null!==(d=t.exec(u)):c.merge(f(a(l(d[1]))),e.when(isNaN,f,(e=>{switch(e){case"undefined":case"false":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}})(l(d[3]))));break;case null!==(d=r.exec(u)):p.splice(0),p.push(...e.compose(e.map(e.replace(i,"$1")),e.ifElse(e.test(o),(e=>[e]),e.split(n)))(u))}}})(),ke=e.curry((([e,t],r)=>{let s,n,o=r.length,i=e.length,l=0,c=[];for(s=0;s<o;s++)switch(r.slice(s,s+i)){case e:s+=i-1,0==l&&(n=s),l++;break;case t:if(s+=i-1,l--,0==l)c.push([n,s]);else if(l<0)throw new Error("fela-vue literal: unbalanced delimeter in functional expression !")}return c})),qe=e.compose(e.join("\n"),e.map((e=>{const t=[];let r=0;for(let[s,n]of ke(["[","]"],e))t.push(e.slice(r,s),`\${${e.slice(s+1,n).replace(/(\W|^)\$([a-zA-Z_]+)\b/g,"$1$$ps.$2").replace(/(\W|^)@(.+?)\b/g,"$1$t.$2")}}`),r=n+1;return t.push(e.slice(r)),t.join("")}))),_e=e=>t=>{const r=[];let s,n,o,i=0,l=[];for(s of t)if(i>0)switch(s){case"{":i++,l[l.length-1]+=s;break;case"}":if(1==--i){if(e){const e=`($ps, $t) => css\`${qe(l)}\``;r.push([o,e])}else{const e=new Function("$t,css,$ps",`return css\`\n                ${qe(l)}\n              \``);r.push([o,(t,r)=>e(r,Re,t)])}i=0,l.splice(0)}else l[l.length-1]+=s;break;default:l.push(s)}else n=s.indexOf("=>"),~n?(i=1,o=s.slice(0,n).trim().replace(/^\./,"")):r.push(s);return r},je=(()=>{const t=["\n","\r",";"],r=e=>t.includes(e),s=b;return(n,o=!1)=>{const i=new A,l=[];return e.compose((()=>i.out),e.forEach((t=>{if("Array"==e.type(t))i.merge(t[0],t[1]);else if(t&&Ne(i,t,l),i.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")})),_e(o),e.filter(e.complement(e.isEmpty)),e.map(e.trim),(c=t,t=>{const r=e.map(e.length,c),s=[];let n,o,i=0,l=c.length,a=t.length;for(n=0;n<a;n++)for(o=0;o<l;o++)t.slice(n,n+r[o])===c[o]&&"\\"!==t[n-1]&&(s.push(t.slice(i,n)),n+=r[o]-1,i=n+1);return i!==t.length-1&&s.push(t.slice(i)),s}),e.replace(/(\{|\})/g,((e,t,s,n)=>(r(n[s-1])||(t=";"+t),r(n[s+1])||(t+=";"),t))),u,e.replace(s,""))(n);var c}})(),Ee=_,ze=(e,t)=>e[t]||e[a(t)],Oe=(t,r,s,n,o)=>{switch(r||(r=l),typeof s){case c.f:return[s.name,[e=>s(e,o)]];case c.o:return[s.className,[e.always(s)]];case c.s:const i=((t,r,s,n,o)=>e.compose(e.qmap((e=>[e,ze(r,e)||ze(t(),e)||l])),e.qmap(e.last),e.qfilter((t=>{if(e.length(t)<2)return!0;const r=e.last(t);let s,i,l;return e.all((t=>{if(i="!"===e.head(t),i&&(t=e.tail(t)),s=n[t],!s)throw new Error(`[fela-vue] Class modifier with name ${t} not found.`);return l=s(r,o),i?!l:l}),e.slice(0,-1,t))})),e.qmap(e.split(Ee)),e.qfilter((e=>""!==e)),e.split(/[,\s\t]+/g))(s))(t,r,s,n,o),a=[],u=[];for(const[e,s]of i)a.push(e),u.push(...Oe(t,r,s,n,o)[1]);return[a.join("_"),u];default:return["",[e.identity]]}},Pe=function(t,r){if(h)for(const s in t){const n=t[s],o=[];for(const t in n){const r=n[t];"Object"==e.type(r)?this.setClasses(r,document.querySelectorAll(s+t)):o.push([t,r])}if(o.length){const t=(0,this.renderClasses)(null,e.fromPairs(o)).split(" ");(r||document.querySelectorAll(s)).forEach((e=>e.classList.add(...t)))}}},Ae=e=>(t,...r)=>je(((e,t)=>e.reduce(((e,r,s)=>e+r+(t.length>s?t[s]:"")),""))(t,r),e),Re=Ae(!1),Be=Ae(!0),Me={method:"f",defStyles:void 0,modifiers:{},plugins:[],enhancers:[],preset:{unit:[]},ssr:!1};class Fe{static devClassNames=!1;renderer;_mixin;renderClasses;styl;get mixin(){return Object.freeze(this._mixin)}get style(){return r.renderToMarkup(this.renderer)}setClasses=Pe;constructor(a={}){const{method:u,ssr:f,preset:p,plugins:d,enhancers:m,...b}=((t,r={})=>e.compose(e.fromPairs,e.map((([t,s])=>{switch(e.type(s)){case"Array":return[t,[...s,...r[t]||[]]];case"Object":return[t,{...s,...r[t]||{}}];default:return[t,r[t]||s]}})),e.toPairs)(t))(Me,a),y={...Me.preset,...p||{}},w=this;if(a.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=t.createRenderer({...b,enhancers:m,plugins:g([i,s,n,o,...d],{0:y.unit})});const{renderer:$}=this,x=a.defStyles;let S,C;switch(typeof x){case c.o:[S,C]=[x.key,x.value];break;case c.f:[S,C]=["fdef",x]}h&&(f?r.rehydrate($):r.render($)),this.renderClasses=(r,s,n=l,o)=>{const[i,c]=Oe((e=>{let t,r=!1;return()=>r?t:(r=!0,t=e())})((()=>C?C(this):l)),r,s,o?e.mergeShallow(a.modifiers,o):a.modifiers,this);return $.renderRule(((e,t,r)=>{if(r&&t&&"anonymous"!==t)return{[t]:(t,r)=>e(t,r)}[t];return e})(t.combineRules(...c),i,Fe.devClassNames),n)||void 0},this.styl=(t,r)=>(s,n,o)=>this.renderClasses(t,s,n,o?e.mergeShallow(r,o):r),this._mixin=e.filter(e.identity,{methods:{[u]:function(t,r,s){return w.renderClasses.call(this,this.style,t,r,s?e.mergeShallow(a.modifiers,s):"styleMods"in this&&this.styleMods)}},computed:x&&{[S](){return C(this)}}})}}let We=null;exports.Renderer=Fe,exports.SvelteRenderer=class extends Fe{static get devClassNames(){return Fe.devClassNames}static set devClassNames(e){Fe.devClassNames=e}f;fdef;getCSS(){return e=>{const t={style:e,fdef:this.fdef};return(e,r)=>this.f.call(t,e,r)}}getLiteralCSS(){const e=this.getCSS();return(...t)=>e(Re(...t))}constructor(e={}){super(e);const t=this.mixin;this.f=t.methods.f,this.fdef="function"==typeof e.defStyles?t.computed.fdef:e.defStyles&&t.computed[e.defStyles.key]}},exports.__specialcss=Be,exports.css=Re,exports.rollupCSSCompression=function(){return{name:"fela-vue-compression",async transform(e){const t=await import("pepka"),{compose:r,take:s,replace:n}=t;We||(We=Se(t));const o=((e,t)=>{const{compose:r,replace:s,trim:n}=t;return r(s($,"$2"),s(w,"$1"),s(y,"$1"),s(b,""),s(S,((t,r,s,o)=>o?r+(s&&o?`${n(e.dic[s]||s)}:${n(e.dic[o]||o)};`:n(s?t.replace(s,e.dic[s]||s):o?t.replace(s,e.dic[o]||o):t)):"")))})(We,t);let i="";try{i=e.replace(E,r((e=>`css\`${o(e)}\``),n(z,n(j," ")),s(1)))}catch(e){console.warn(e)}return{code:i||e,map:null}}}},exports.setCompression=e=>Ce=e;
