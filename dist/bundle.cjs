"use strict";var e=require("pepka"),t=require("fela"),r=require("fela-dom"),s=require("fela-plugin-embedded"),n=require("fela-plugin-prefixer"),o=require("fela-plugin-fallback-value"),i=require("fela-plugin-unit");const l=Object.freeze({}),c=Object.freeze({f:"function",o:"object",s:"string"}),a=e=>e.replace(/-(\w)/gu,((e,t)=>t.toUpperCase())),u=(()=>{const e=/url\(.*?\)/g,t=/[,:;]/g;return r=>r.replace(e,(e=>e.replace(t,(e=>`\\${e}`))))})(),f=e.when(e.complement(e.isNil),e.replace(/([^\\])\\([^\\])/g,"$1$2")),p=e.both(e.complement(e.isEmpty),e.complement(e.isNil));e.compose(e.equals("Object"),e.type);const h=e.compose(e.equals("Window"),e.type),d=(()=>{try{return h(window)}catch{return!1}})(),m=e.map(e.ifElse(e.compose(e.equals("Function"),e.type),e.identity,e.prop("default"))),g=(t,r)=>e.compose(e.map((([e,t])=>((e,t,r)=>r(...e[t]||[]))(r,e,t))),e.toPairs,m)(t),b=/((\s+?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,y=/[\n\r]{2,}|(?:;\s)/g,w=/(^|\r|\n)+[\t ]+/g,$=/[;\n\r]+/g,x=/(?:(}|{|]|)^[;\n\r ]+)|(?:[;\n\r ]+($|}|{|]))/g,C=/^([\w-]+)(: *| +)(.*)$/,v=/(^|\r|\n|;|{)\s*([a-z-]+)[ :][\t ]*?:?[\t ]*?([^;\r\n]+)/g,S=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,N=/^\.\.\.(\S*)$/,k=/\s*,\s*/g,q=/(.*):$/,_=/[.&]/;class j{s;rules={};__selector__=!0;get complex(){return null!==this.s.className&&null!==this.s.modifier}static isSelector(e){return Boolean(e&&e.__selector__)}serialize(){const{className:e,modifier:t}=this.s;return(e?`.${e}`:"")+(t||"")}findClass(e,t=this){if(t.s.className===e)return t;for(const r in t.rules){const s=t.rules[r];if(j.isSelector(s)){const t=s.findClass(e);if(t)return t}}return null}constructor(e){const t=e.match(/^\.[\w-_]+/);this.s={className:t?t[0].slice(1):null,modifier:t?e.slice(t[0].length)||null:e}}}const E=(t,r=0)=>{const s={};let n,o,i,l,c;for(c in t.rules)n=t.rules[c],j.isSelector(n)?(o=n.complex?n.s.className:n.serialize(),i=0==r&&"."==o[0]?o.slice(1):"."==o[0]?`& ${o}`:o,l=n.complex?{[n.s.modifier]:E(n,r+1)}:E(n,r+1),s[i]?e.qmergeDeep(s[i],l):s[i]=l):s[c]=n;return s};class O{path=[];get out(){return E(this.path[0][0])}get depth(){return this.path.length}add(t){const r=e.last(this.path),s=[];for(const e of t){const t=new j(e);for(const e of r){const r=t.serialize(),n=e.rules[r];s.push(n||t),n||(e.rules[r]=t)}}this.path.push(s)}merge(t,r){if(p(r)&&p(t))for(const s of e.last(this.path))s.rules[t]=r}findClass(e){for(const t of this.path)for(const r of t){const t=r.findClass(e);if(t)return t}return null}pop(){return this.path.pop()}constructor(){this.path.push([new j("__root")])}}const P=Symbol("Placeholder"),z=e=>{let t=0;for(const r of e)r!==P&&t++;return t},A=(e,t)=>{const r=e.length,s=e.slice(),n=t.length;let o=n,i=0;for(;o&&i<r;i++)s[i]===P&&(s[i]=t[n-o],o--);for(i=r;o;i++,o--)s[i]=t[n-o];return s},R=(e,t,r)=>{const s=e.length-t.length-z(r);if(s<1)return e(...A(t,r));{const n=(...s)=>R(e,A(t,r),s);return n.$args_left=s,n}},B=e=>(...t)=>e.length>z(t)?R(e,[],t):e(...t),F=e=>function(t){return t===P?e:e(t)};function W(e){return function(t,r){const s=t===P,n=arguments.length;if(1===n&&s)throw new Error("Senseless placeholder usage.");return arguments.length>1?s?F((t=>e(t,r))):e(t,r):r=>e(t,r)}}function L(e){return B(e)}const M=void 0,U=1/0,D=e=>typeof e,T=e=>null===e,Z={u:"U",b:"B",n:"N",s:"S",f:"F"},G=e=>{const t=D(e);return"object"===t?T(e)?"Null":e.constructor.name:Z[t[0]]+t.slice(1)},H=W(((e,t)=>(t.push(e),t))),I=L(((e,t,r)=>r.reduce(e,t))),J=L(((e,t,r)=>{for(let s in r)switch(G(r[s])){case"Array":if(e>1&&"Array"===G(t[s]))switch(e){case 2:const n=t[s],o=r[s];for(const t in o)n[t]?J(e,n[t],o[t]):n[t]=o[t];break;case 3:t[s].push(...r[s])}else t[s]=r[s];break;case"Object":if("Object"===G(t[s])){J(e,t[s],r[s]);break}default:t[s]=r[s]}return t}));J(1),J(2),J(3);const K=W(((e,t)=>{const r=G(e);if(r===G(t)&&("Object"===r||"Array"==r)){if(T(e)||T(t))return e===t;if(e===t)return!0;for(const r of[e,t])for(const s in r)if(!(r===t&&s in e||r===e&&s in t&&K(e[s],t[s])))return!1;return!0}return e===t})),Q=B(((e,t,r,s)=>e(s)?t(s):r(s))),V=(...e)=>(...t)=>{let r,s=!0;for(let n=se(e)-1;n>-1;n--)s?(s=!1,r=e[n](...t)):r=r===P?e[n]():e[n](r);return r},X=W(((e,t)=>t[e])),Y=W(((e,t)=>{if((e=>"string"===D(e))(t))return t.includes(e);for(const r of t)if(K(r,e))return!0;return!1})),ee=L(((e,t,r)=>r.slice(e,(e=>"number"==D(e))(t)?t:U))),te=X(0);ee(1,U);const re=e=>T(e)||(e=>e===M)(e),se=e=>e.length,ne=e=>()=>e,oe=W(((e,t)=>t.split(e))),ie=e=>I(((e,t)=>Y(t,e)?e:H(t,e)),[],e),le=L(((e,t,r)=>({...r,[e]:t}))),ce=W(((e,t)=>t[e])),ae=L(((e,t,r)=>Q(se,(()=>re(r)?e:V(Q(re,ne(e),(r=>ae(e,ee(1,U,t),r))),(e=>W(((t,r)=>e(r,t))))(ce)(r),te)(t)),ne(r),t)));ae(M);const ue=/^(.*?)(8|16|32|64)(Clamped)?Array$/,fe=(e,t=!1)=>{const r=G(e);switch(r){case"Null":case"String":case"Number":case"Boolean":case"Symbol":return e;case"Array":return t?[...e]:he(V(fe,((...e)=>e[0])),e);case"Object":if(t)return{...e};const s={};for(let t in e)s[t]=fe(e[t]);return s;default:return ue.test(r)?e.constructor.from(e):e}},pe=L(((e,t,r)=>I(e,fe(t),r))),he=W(((e,t)=>t.map(e))),{floor:de}=Math;let me,ge;const be=V((e=>pe(((e,t)=>le(...t,e)),{},e)),he(((e,t)=>[e,t])),oe(""));(e=>{if(!(e=>V(K(se(e)),se,ie,oe(""))(e))(e))throw new Error("Not all chars are unique!");me=e,ge=me.length,be(me)})("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");const ye="\ntop flex grid overflow transform transition-duration max-height 100%\nmargin margin-top margin-left margin-bottom margin-right justify-content\nborder width height left border-radius background bottom position align-items\ncenter bottom absolute relative float right opacity z-index min-width\nmin-height border-top border-bottom border-left border-right filter\nfont-weight font-size none hidden auto display block inline inline-block\npadding padding-top padding-bottom padding-left padding-right text-align\nflex-direction column box-shadow rotate content text-decoration\nfixed color space-between overflow-x overflow-y\n".replace(/\s+/g,",").split(/[, ]/g).filter(Boolean),we=()=>{let e=0;return()=>`a${(e=>{let t="";for(;e>0;)t=me[e%ge]+t,e=de(e/ge);return t||"0"})(e++)}`},$e=e=>{const t=we(),{compose:r,fromPairs:s,map:n,reverse:o,toPairs:i}=e,l=r(s,n((e=>[e,t()])))(ye);return{dic:l,dicRev:r(s,n(o),i)(l)}};let xe=!1;const Ce=$e({compose:e.compose,fromPairs:e.fromPairs,map:e.map,reverse:e.reverse,toPairs:e.toPairs}),ve=(()=>{const t=C,r=S,s=N,n=k,o=q,i=e.when((()=>xe),(e=>Ce.dicRev[e]||e));return(l,c,u)=>{let p;switch(!0){case"{"==c:l.add(u);break;case"}"==c:l.pop();break;case null!==(p=s.exec(c)):const h=l.findClass(p[1]);if(h)for(const e in h.rules)l.merge(e,h.rules[e]);break;case null!==(p=t.exec(c)):l.merge(f(a(i(p[1]))),e.when(isNaN,f,(e=>{switch(e){case"undefined":case"false":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}})(i(p[3]))));break;case null!==(p=r.exec(c)):u.splice(0),u.push(...c.split(n).map((e=>e.replace(o,"$1"))))}}})(),Se=e.curry((([e,t],r)=>{let s,n,o=r.length,i=e.length,l=0,c=[];for(s=0;s<o;s++)switch(r.slice(s,s+i)){case e:s+=i-1,0==l&&(n=s),l++;break;case t:if(s+=i-1,l--,0==l)c.push([n,s]);else if(l<0)throw new Error("fela-vue literal: unbalanced delimeter in functional expression !")}return c})),Ne=e.compose(e.join("\n"),e.map((e=>{const t=[];let r=0;for(let[s,n]of Se(["[","]"],e))t.push(e.slice(r,s),`\${${e.slice(s+1,n).replace(/(\W|^)\$([a-zA-Z_]+)\b/g,"$1$$ps.$2").replace(/(\W|^)@(.+?)\b/g,"$1$t.$2")}}`),r=n+1;return t.push(e.slice(r)),t.join("")}))),ke=e=>t=>{const r=[];let s,n,o,i=0,l=[];for(s of t)if(i>0)switch(s){case"{":i++,l[l.length-1]+=s;break;case"}":if(1==--i){if(e){const e=`($ps, $t) => css\`${Ne(l)}\``;r.push([o,e])}else{const e=new Function("$t,css,$ps",`return css\`\n                ${Ne(l)}\n              \``);r.push([o,(t,r)=>e(r,ze,t)])}i=0,l.splice(0)}else l[l.length-1]+=s;break;default:l.push(s)}else n=s.indexOf("=>"),~n?(i=1,o=s.slice(0,n).trim().replace(/^\./,"")):r.push(s);return r},qe=(()=>{const t=["\n","\r",";"],r=e=>t.includes(e),s=b;return(n,o=!1)=>{const i=new O,l=[];return e.compose((()=>i.out),e.forEach((t=>{if("Array"==e.type(t))i.merge(t[0],t[1]);else if(t&&ve(i,t,l),i.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")})),ke(o),e.filter(e.complement(e.isEmpty)),e.map(e.trim),(c=t,t=>{const r=e.map(e.length,c),s=[];let n,o,i=0,l=c.length,a=t.length;for(n=0;n<a;n++)for(o=0;o<l;o++)t.slice(n,n+r[o])===c[o]&&"\\"!==t[n-1]&&(s.push(t.slice(i,n)),n+=r[o]-1,i=n+1);return i!==t.length-1&&s.push(t.slice(i)),s}),e.replace(/(\{|\})/g,((e,t,s,n)=>(r(n[s-1])||(t=";"+t),r(n[s+1])||(t+=";"),t))),u,e.replace(s,""))(n);var c}})(),_e=_,je=(e,t)=>e[t]||e[a(t)],Ee=(t,r,s,n,o)=>{switch(r||(r=l),typeof s){case c.f:return[s.name,[e=>s(e,o)]];case c.o:return[s.className,[e.always(s)]];case c.s:const i=((t,r,s,n,o)=>e.compose(e.qmap((e=>[e,je(r,e)||je(t(),e)||l])),e.qmap(e.last),e.qfilter((t=>{if(e.length(t)<2)return!0;const r=e.last(t);let s,i,l;return e.all((t=>{if(i="!"===e.head(t),i&&(t=e.tail(t)),s=n[t],!s)throw new Error(`[fela-vue] Class modifier with name ${t} not found.`);return l=s(r,o),i?!l:l}),e.slice(0,-1,t))})),e.qmap(e.split(_e)),e.split(/[,\s\t]+/g))(s))(t,r,s,n,o),a=[],u=[];for(const[e,s]of i)a.push(e),u.push(...Ee(t,r,s,n,o)[1]);return[a.join("_"),u];default:return["",[e.identity]]}},Oe=function(t,r){if(d)for(const s in t){const n=t[s],o=[];for(const t in n){const r=n[t];"Object"==e.type(r)?this.setClasses(r,document.querySelectorAll(s+t)):o.push([t,r])}if(o.length){const t=(0,this.renderClasses)(null,e.fromPairs(o)).split(" ");(r||document.querySelectorAll(s)).forEach((e=>e.classList.add(...t)))}}},Pe=e=>(t,...r)=>qe(((e,t)=>e.reduce(((e,r,s)=>e+r+(t.length>s?t[s]:"")),""))(t,r),e),ze=Pe(!1),Ae=Pe(!0),Re={method:"f",defStyles:void 0,modifiers:{},plugins:[],enhancers:[],preset:{unit:[]},ssr:!1};class Be{static devClassNames=!1;renderer;_mixin;renderClasses;styl;get mixin(){return Object.freeze(this._mixin)}get style(){return r.renderToMarkup(this.renderer)}setClasses=Oe;constructor(a={}){const{method:u,ssr:f,preset:p,plugins:h,enhancers:m,...b}=((t,r={})=>e.compose(e.fromPairs,e.map((([t,s])=>{switch(e.type(s)){case"Array":return[t,[...s,...r[t]||[]]];case"Object":return[t,{...s,...r[t]||{}}];default:return[t,r[t]||s]}})),e.toPairs)(t))(Re,a),y={...Re.preset,...p||{}},w=this;if(a.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=t.createRenderer({...b,enhancers:m,plugins:g([i,s,n,o,...h],{0:y.unit})});const{renderer:$}=this,x=a.defStyles;let C,v;switch(typeof x){case c.o:[C,v]=[x.key,x.value];break;case c.f:[C,v]=["fdef",x]}d&&(f?r.rehydrate($):r.render($)),this.renderClasses=(e,r,s={})=>{const[n,o]=Ee((e=>{let t,r=!1;return()=>r?t:(r=!0,t=e())})((()=>v?v(this):l)),e,r,a.modifiers,this);return $.renderRule(((e,t,r)=>{if(r&&t&&"anonymous"!==t)return{[t]:(t,r)=>e(t,r)}[t];return e})(t.combineRules(...o),n,Be.devClassNames),s)||void 0},this.styl=e=>(...t)=>this.renderClasses(e,...t),this._mixin=e.filter(e.identity,{methods:{[u]:function(...e){return w.renderClasses.call(this,this.style,...e)}},computed:x&&{[C](){return v(this)}}})}}let Fe=null;exports.Renderer=Be,exports.SvelteRenderer=class extends Be{static get devClassNames(){return Be.devClassNames}static set devClassNames(e){Be.devClassNames=e}f;fdef;getCSS(){return e=>{const t={style:e,fdef:this.fdef};return(e,r)=>this.f.call(t,e,r)}}getLiteralCSS(){const e=this.getCSS();return(...t)=>e(ze(...t))}constructor(e={}){super(e);const t=this.mixin;this.f=t.methods.f,this.fdef="function"==typeof e.defStyles?t.computed.fdef:e.defStyles&&t.computed[e.defStyles.key]}},exports.__specialcss=Ae,exports.css=ze,exports.rollupCSSCompression=function(){return{name:"fela-vue-compression",async transform(e){const t=await import("pepka"),{compose:r,take:s}=t;Fe||(Fe=$e(t));const n=((e,t)=>{const{compose:r,replace:s,trim:n}=t;return r(s(x,"$2"),s($,";"),s(y,"\n"),s(w,"$1"),s(b,""),s(v,((t,r,s,o)=>o?r+(s&&o?`${n(e.dic[s]||s)}:${n(e.dic[o]||o)};`:n(s?t.replace(s,e.dic[s]||s):o?t.replace(s,e.dic[o]||o):t)):"")))})(Fe,t);let o=e;try{o=e.replace(/css\`((.|\s)*?)\`/g,r((e=>`css\`${n(e)}\``),s(1)))}catch(e){console.warn(e)}return{code:o,map:null}}}},exports.setCompression=e=>xe=e;
